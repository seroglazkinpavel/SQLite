1. Найдите потоки, количество учеников в которых больше или равно 40. В отчет выведите номер потока, название курса и количество учеников.

Делаем таблицу заглушку.
SELECT
    stream_number,
    course_name,
    students_amount
 FROM streams;
 По этому шаблону будем делать наш отчет. Вставим команды вместо заглушек
 SELECT
     stream_number,
     (SELECT name FROM courses WHERE id = course_id) AS course_name,
     students_amount
 FROM streams WHERE students_amount >= 40;

2. Найдите два потока с самыми низкими значениями успеваемости. В отчет выведите номер потока, название курса, фамилию и имя преподавателя (одним столбцом), оценку успеваемости.

Находим два потока с самыми низкими значениями успеваемости.
SELECT grade FROM grades ORDER BY grade LIMIT 2;
Делаем таблицу заглушку.
 SELECT
    'grade'
    stream_number,
    'course_name',
    'teacher_name'
 FROM grades ORDER BY grode LIMIT 2;
 По этому шаблону будем делать наш отчет. Вставим команды вместо заглушек
  SELECT
     grade,
	 (SELECT number FROM streams WHERE id = stream_id) AS stream_number,   // Почемуто не вывелся. В чем причина?
     (SELECT name FROM courses WHERE id = stream_id) AS course_name,
     (SELECT name ||surname FROM teachers WHERE id = teachers_id) AS teacher_name
  FROM grades ORDER BY grade LIMIT 2;

3. Найдите среднюю успеваемость всех потоков преподавателя Николая Савельева. В отчёт выведите идентификатор преподавателя и среднюю оценку по потокам.

Находим все потоки Николая Савельева.
SELECT id FROM teachers WHERE surname = 'Савельев' AND name = 'Николай';
Делаем таблицу заглушку.
 SELECT
    'teacher_id',
    AVG(grade)
 FROM grades;
 По этому шаблону будем делать наш отчет. Вставим команды вместо заглушек
  SELECT
	 (SELECT id FROM teachers WHERE surname = 'Савельев' AND name = 'Николай') AS teacher_id,
     AVG(grade)
  FROM grades WHERE (SELECT id FROM teachers WHERE surname = 'Савельев' AND name = 'Николай');

4. Найдите потоки преподавателя Натальи Петровой, а также потоки, по которым успеваемость ниже 4.8. В отчёт выведите идентификатор потока, фамилию и имя преподавателя.

Найдем потоки Натальи Петровой.
SELECT stream_number FROM streams WHERE id = (SELECT stream_id FROM grades WHERE teacher_id = (SELECT id FROM teeachers WEHERE surname = 'Петрова' AND name = 'Наталья'));
Находим потоки успеваемости которые ниже 4.8
SELECT
    stream_id,
    (SELECT name || surname FROM teachers WHERE id = teacher_id) AS teacher_name
    FROM grades
WHERE grade < 4.8;
Объединяем с помощью комонды UNION
    SELECT
        stream_number FROM streams
    WHERE id = (SELECT stream_id FROM grades
    WHERE teacher_id = (SELECT id FROM teeachers WEHERE surname = 'Петрова' AND name = 'Наталья'))
    UNION ALL
    SELECT
        (SELECT name || surname FROM teachers WHERE id = teacher_id) AS teacher_name
        FROM grades
    WHERE grade < 4.8;